<script lang="ts">
	import anime from 'animejs/lib/anime.es';
	import { browser } from '$app/env';
	import { currentExpression, isTalking } from '$lib/stores/bot';

	export let expressionSize = 300;

	let exprSize = `${expressionSize}px`;

	const expressionPaths = {
		neutral: {
			expression: 'neutral',
			face: '#FFE600',
			r_eyebrow:
				'M199.5 67.5789C199.5 67.5789 188.307 48.5789 174.5 48.5789C160.693 48.5789 149.5 67.5789 149.5 67.5789C149.5 53.7717 160.693 42.5789 174.5 42.5789C188.307 42.5789 199.5 53.7717 199.5 67.5789Z',
			l_eyebrow:
				'M99 68C99 68 87.8071 49 74 49C60.1929 49 49 68 49 68C49 54.1929 60.1929 43 74 43C87.8071 43 99 54.1929 99 68Z',
			l_eye:
				'M88.5 113C88.5 125.703 86.7025 136 74 136C61.2975 136 59 125.703 59 113C59 100.297 61.2975 90 74 90C86.7025 90 88.5 100.297 88.5 113Z',
			r_eye:
				'M189.5 113C189.5 125.703 187.703 136 175 136C162.297 136 160 125.703 160 113C160 100.297 162.297 90 175 90C187.703 90 189.5 100.297 189.5 113Z',
			mouse:
				'M141 184.582C141 192.942 133.837 194 125 194C116.163 194 109 192.942 109 184.582C109 176.223 116.163 178.205 125 178.205C133.837 178.205 141 176.223 141 184.582Z',
			option_sad1: '',
			option_sad2: '',
			option_fear1: '',
			option_fear2: '',
			option_disgust: ''
		},

		happiness: {
			expression: 'happiness',
			face: '#FFE600',
			r_eye:
				'M201 105C201 105 189.807 93.0788 176 93.0788C162.193 93.0788 151 105 151 105C151 91.1929 162.193 80 176 80C189.807 80 201 91.1929 201 105Z',
			l_eye:
				'M100 105.421C100 105.421 88.8071 93.5 75 93.5C61.1929 93.5 50 105.421 50 105.421C50 91.6141 61.1929 80.4212 75 80.4212C88.8071 80.4212 100 91.6141 100 105.421Z',
			l_eyebrow:
				'M100 72.4212C100 72.4212 88.8071 53.4212 75 53.4212C61.1929 53.4212 50 72.4212 50 72.4212C50 58.6141 61.1929 47.4212 75 47.4212C88.8071 47.4212 100 58.6141 100 72.4212Z',
			r_eyebrow:
				'M200.5 72C200.5 72 189.307 53 175.5 53C161.693 53 150.5 72 150.5 72C150.5 58.1929 161.693 47 175.5 47C189.307 47 200.5 58.1929 200.5 72Z',
			mouse:
				'M208 144C208 190.116 170.616 227.5 124.5 227.5C78.3842 227.5 41 190.116 41 144C41 144 78.3842 144 124.5 144C170.616 144 208 144 208 144Z',
			option_sad1: '',
			option_sad2: '',
			option_fear1: '',
			option_fear2: '',
			option_disgust: ''
		},

		worry: {
			expression: 'worry',
			face: '#FFE600',
			l_eyebrow:
				'M54 57.4035C54 57.4035 71.1063 71.3195 84.05 66.5136C96.9938 61.7078 100.873 40 100.873 40C105.679 52.9437 99.0822 67.3326 86.1385 72.1385C73.1947 76.9443 58.8058 70.3472 54 57.4035Z',
			r_eyebrow:
				'M149.661 40.7056C149.661 40.7056 152.694 62.5479 165.441 67.8536C178.188 73.1592 195.822 59.9191 195.822 59.9191C190.517 72.6661 175.882 78.6986 163.135 73.3929C150.388 68.0873 144.356 53.4527 149.661 40.7056Z',
			l_eye:
				'M95.5 107C95.5 119.703 93.7025 130 81 130C68.2975 130 66 119.703 66 107C66 94.2975 68.2975 84 81 84C93.7025 84 95.5 94.2975 95.5 107Z',
			r_eye:
				'M185.5 107C185.5 119.703 183.703 130 171 130C158.297 130 156 119.703 156 107C156 94.2975 158.297 84 171 84C183.703 84 185.5 94.2975 185.5 107Z',
			mouse:
				'M155 186.201C155 193.433 149.976 194 125.855 194C101.733 194 96 193.433 96 186.201C96 178.97 101.733 167 125.855 167C149.976 167 155 178.97 155 186.201Z',
			option_sad1: '',
			option_sad2: '',
			option_fear1: '',
			option_fear2: '',
			option_disgust: ''
		},

		anger: {
			expression: 'anger',
			face: '#FF3D3D',
			l_eye:
				'M87.5 110C87.5 122.703 85.7025 133 73 133C60.2975 133 58 122.703 58 110C58 97.2975 60.2975 87 73 87C85.7025 87 87.5 97.2975 87.5 110Z',
			r_eye:
				'M194.5 110C194.5 122.703 192.703 133 180 133C167.297 133 165 122.703 165 110C165 97.2975 167.297 87 180 87C192.703 87 194.5 97.2975 194.5 110Z',
			l_eyebrow:
				'M27.3913 11C27.3913 11 33.841 37.2786 54.3516 55.7681C74.8622 74.2576 101.667 77.9564 101.667 77.9564C94.2709 86.1607 71.6483 77.8228 51.1377 59.3333C30.6271 40.8438 19.9955 19.2042 27.3913 11Z',
			r_eyebrow:
				'M151 78.0755C151 78.0755 177.846 74.6931 198.574 56.4469C219.301 38.2006 226.06 12 226.06 12C233.359 20.2909 222.473 41.8035 201.745 60.0498C181.018 78.296 158.299 86.3664 151 78.0755Z',
			mouse:
				'M178 201C178 231.992 158.705 209 127.224 209C95.7429 209 77.5 231.992 77.5 201C77.5 170.008 95.7429 193.5 127.224 193.5C158.705 193.5 178 170.008 178 201Z',
			option_sad1: '',
			option_sad2: '',
			option_fear1: '',
			option_fear2: '',
			option_disgust: ''
		},

		surprise: {
			expression: 'surprise',
			face: '#FFE600',
			r_eyebrow:
				'M199.5 42.5789C199.5 42.5789 188.307 23.5789 174.5 23.5789C160.693 23.5789 149.5 42.5789 149.5 42.5789C149.5 28.7717 160.693 17.5789 174.5 17.5789C188.307 17.5789 199.5 28.7717 199.5 42.5789Z',
			l_eyebrow:
				'M99 43C99 43 87.8071 24 74 24C60.1929 24 49 43 49 43C49 29.1929 60.1929 18 74 18C87.8071 18 99 29.1929 99 43Z',
			r_eye:
				'M189 94C189 107.807 187.233 119 174.746 119C162.259 119 160 107.807 160 94C160 80.1929 162.259 69 174.746 69C187.233 69 189 80.1929 189 94Z',
			l_eye:
				'M88 94C88 107.807 86.233 119 73.7458 119C61.2585 119 59 107.807 59 94C59 80.1929 61.2585 69 73.7458 69C86.233 69 88 80.1929 88 94Z',
			mouse:
				'M171 209.832C171 252.778 163.166 256 125.553 256C87.9395 256 79 252.778 79 209.832C79 166.887 87.9395 159 125.553 159C163.166 159 171 166.887 171 209.832Z',
			option_sad1: '',
			option_sad2: '',
			option_fear1: '',
			option_fear2: '',
			option_disgust: ''
		},

		sadness: {
			expression: 'sadness',
			face: '#FFE600',
			r_eye:
				'M194 111.058C194 119.927 191.928 111.058 177.288 111.058C162.648 111.058 160 119.927 160 111.058C160 102.19 162.648 95 177.288 95C191.928 95 194 102.19 194 111.058Z',
			l_eye:
				'M90 111.058C90 119.927 87.9284 111.058 73.2881 111.058C58.6479 111.058 56 119.927 56 111.058C56 102.19 58.6479 95 73.2881 95C87.9284 95 90 102.19 90 111.058Z',
			r_eyebrow:
				'M166.203 40C166.203 40 166.698 62.0463 178.748 68.786C190.798 75.5257 209.842 64.4067 209.842 64.4067C203.102 76.4572 187.87 80.7623 175.819 74.0226C163.769 67.2829 159.464 52.0504 166.203 40Z',
			l_eyebrow:
				'M40 63.2016C40 63.2016 58.991 74.4098 71.0729 67.7267C83.1548 61.0436 83.7525 39 83.7525 39C90.4356 51.0819 86.059 66.2939 73.9771 72.977C61.8951 79.6601 46.6831 75.2835 40 63.2016Z',
			mouse:
				'M158 188.846C158 214 152.38 202.5 125.397 202.5C98.4131 202.5 92 213.5 92 188.846C92 181.748 98.4131 170 125.397 170C152.38 170 158 181.748 158 188.846Z',
			option_sad1:
				'M194 115L199.735 134.007C200.488 136.504 199.539 139.202 197.388 140.677C195.346 142.077 192.654 142.077 190.612 140.677C188.461 139.202 187.512 136.504 188.265 134.007L194 115Z',
			option_sad2:
				'M56 115L61.7348 134.007C62.4883 136.504 61.539 139.202 59.3876 140.677C57.3461 142.077 54.6539 142.077 52.6124 140.677C50.4611 139.202 49.5117 136.504 50.2653 134.007L56 115Z',
			option_fear1: '',
			option_fear2: '',
			option_disgust: ''
		},

		fear: {
			expression: 'fear',
			face: '#FFE600',
			r_eye:
				'M193 118.525C193 137.593 190.928 118.525 176.288 118.525C161.648 118.525 159 137.593 159 118.525C159 99.4575 161.648 84 176.288 84C190.928 84 193 99.4575 193 118.525Z',
			l_eye:
				'M96 118.525C96 137.593 93.9284 118.525 79.2881 118.525C64.6479 118.525 62 137.593 62 118.525C62 99.4575 64.6479 84 79.2881 84C93.9284 84 96 99.4575 96 118.525Z',
			r_eyebrow:
				'M158.782 43.9658C158.782 43.9658 159.277 66.0121 171.327 72.7518C183.378 79.4915 202.421 68.3726 202.421 68.3726C195.681 80.423 180.449 84.7281 168.398 77.9884C156.348 71.2487 152.043 56.0163 158.782 43.9658Z',
			l_eyebrow:
				'M46.0734 68.6627C46.0734 68.6627 65.0644 79.8709 77.1463 73.1878C89.2282 66.5047 89.8259 44.4611 89.8259 44.4611C96.509 56.543 92.1324 71.755 80.0505 78.4381C67.9686 85.1212 52.7565 80.7446 46.0734 68.6627Z',
			mouse:
				'M158 204.846C158 211.943 152.721 204.846 127.373 204.846C102.024 204.846 96 211.943 96 204.846C96 197.748 102.024 186 127.373 186C152.721 186 158 197.748 158 204.846Z',
			option_fear1:
				'M35 84L40.7348 103.007C41.4883 105.504 40.539 108.202 38.3876 109.677V109.677C36.3461 111.077 33.6539 111.077 31.6124 109.677V109.677C29.4611 108.202 28.5117 105.504 29.2653 103.007L35 84Z',
			option_fear2:
				'M17 113L22.7348 132.007C23.4883 134.504 22.539 137.202 20.3876 138.677V138.677C18.3461 140.077 15.6539 140.077 13.6124 138.677V138.677C11.4611 137.202 10.5117 134.504 11.2653 132.007L17 113Z',
			option_sad1: '',
			option_sad2: '',
			option_disgust: ''
		},

		disgust: {
			expression: 'disgust',
			face: '#FFE600',
			l_eye:
				'M91 109.011C91 116.198 88 116.5 71.339 111.5C53.5 116.5 51 116.198 51 109.011C51 101.825 54.1152 96 71.339 96C88.5628 96 91 101.825 91 109.011Z',
			r_eye:
				'M198 109.011C198 116.198 195 116.5 178.339 111.5C160.5 116.5 158 116.198 158 109.011C158 101.825 161.115 96 178.339 96C195.563 96 198 101.825 198 109.011Z',
			r_eyebrow:
				'M203 87.1365C203 87.1365 184.807 92.1365 171 92.1365C157.193 92.1365 153 87.1365 153 87.1365C153 73.3294 157.193 87.1365 171 87.1365C184.807 87.1365 203 73.3294 203 87.1365Z',
			l_eyebrow:
				'M95.995 80.713C95.995 80.713 90.4768 83.0614 76.7714 81.3878C63.0661 79.7142 46.3637 74.6522 46.3637 74.6522C48.0373 60.9469 65.1612 74.9328 78.8665 76.6065C92.5718 78.2801 97.6686 67.0077 95.995 80.713Z',
			mouse:
				'M171 168.446C171 191.449 152.137 168.446 119 168.446C85.8629 168.446 59 185.657 59 159.396C59 159.396 59 124.4 119 150.946C179 150.946 171 168.446 171 168.446Z',
			option_disgust:
				'M130.617 181.553C134.43 184.427 130.687 186.255 126.662 183.686C124.299 182.179 121.606 181.024 118.666 180.702C115.727 180.38 112.847 180.924 110.215 181.884C105.728 183.52 102.47 180.925 106.815 178.945C110.317 177.349 114.574 176.637 119.058 177.128C123.542 177.62 127.543 179.236 130.617 181.553Z',
			option_sad1: '',
			option_sad2: '',
			option_fear1: '',
			option_fear2: ''
		},

		contempt: {
			expression: 'contempt',
			face: '#FFE600',
			l_eye:
				'M89.5 110C89.5 122.703 87.7025 133 75 133C62.2975 133 60 122.703 60 110C60 110 62.2975 110 75 110C87.7025 110 89.5 110 89.5 110Z',
			r_eye:
				'M189.5 110C189.5 122.703 187.703 133 175 133C162.297 133 160 122.703 160 110C160 110 162.297 110 175 110C187.703 110 189.5 110 189.5 110Z',
			r_eyebrow:
				'M200 100C200 100 188.807 81 175 81C161.193 81 150 100 150 100C150 86.1929 161.193 75 175 75C188.807 75 200 86.1929 200 100Z',
			l_eyebrow:
				'M100 80C100 80 88.8071 61 75 61C61.1929 61 50 80 50 80C50 66.1929 61.1929 55 75 55C88.8071 55 100 66.1929 100 80Z',
			mouse:
				'M167.705 196.257C166.864 201.503 158.814 200.615 120.464 194.463C82.1143 188.311 73.063 186.455 73.9046 181.209C74.7461 175.963 84.0151 176.462 122.365 182.614C160.714 188.766 168.547 191.011 167.705 196.257Z',
			option_disgust: '',
			option_sad1: '',
			option_sad2: '',
			option_fear1: '',
			option_fear2: ''
		},

		think: {
			expression: 'think',
			face: '#FFE600',
			l_eye:
				'M67.5 96C67.5 108.703 65.7025 119 53 119C40.2975 119 38 108.703 38 96C38 83.2975 40.2975 73 53 73C65.7025 73 67.5 83.2975 67.5 96Z',
			r_eye:
				'M168.5 96C168.5 108.703 166.703 119 154 119C141.297 119 139 108.703 139 96C139 83.2975 141.297 73 154 73C166.703 73 168.5 83.2975 168.5 96Z',
			r_eyebrow:
				'M178.5 50.5789C178.5 50.5789 167.307 31.5789 153.5 31.5789C139.693 31.5789 128.5 50.5789 128.5 50.5789C128.5 36.7717 139.693 25.5789 153.5 25.5789C167.307 25.5789 178.5 36.7717 178.5 50.5789Z',
			l_eyebrow:
				'M78 51C78 51 66.8071 32 53 32C39.1929 32 28 51 28 51C28 37.1929 39.1929 26 53 26C66.8071 26 78 37.1929 78 51Z',
			mouse:
				'M111 161.005C111 167.743 105.851 171 99.5 171C93.1487 171 88 167.743 88 161.005C88 154.267 93.1487 151 99.5 151C105.851 151 111 154.267 111 161.005Z'
		},

		listen: {
			expression: 'listen',
			face: '#FFE600',
			l_eye:
				'M70.5 129C70.5 141.703 68.7025 152 56 152C43.2975 152 41 141.703 41 129C41 116.297 43.2975 106 56 106C68.7025 106 70.5 116.297 70.5 129Z',
			r_eye:
				'M171.5 129C171.5 141.703 169.703 152 157 152C144.297 152 142 141.703 142 129C142 116.297 144.297 106 157 106C169.703 106 171.5 116.297 171.5 129Z',
			r_eyebrow:
				'M181.5 83.5789C181.5 83.5789 170.307 64.5789 156.5 64.5789C142.693 64.5789 131.5 83.5789 131.5 83.5789C131.5 69.7717 142.693 58.5789 156.5 58.5789C170.307 58.5789 181.5 69.7717 181.5 83.5789Z',
			l_eyebrow:
				'M81 84C81 84 69.8071 65 56 65C42.1929 65 31 84 31 84C31 70.1929 42.1929 59 56 59C69.8071 59 81 70.1929 81 84Z',
			mouse:
				'M123 200.582C123 208.942 115.837 210 107 210C98.1634 210 91 208.942 91 200.582C91 192.223 98.1634 194.205 107 194.205C115.837 194.205 123 192.223 123 200.582Z'
		}
	};
	const morph = (expressionPath) => {
		const time = 1000;

		const timeline0 = anime.timeline({
			duration: time,
			easing: 'easeOutExpo'
		});

		timeline0.add({
			targets: '.face',
			fill: [{ value: expressionPath.face }]
		});

		const timeline1 = anime.timeline({
			duration: time,
			easing: 'easeOutExpo'
		});

		timeline1.add({
			targets: '.r_eye',
			d: [{ value: expressionPath.r_eye }]
		});

		const timeline2 = anime.timeline({
			duration: time,
			easing: 'easeOutExpo'
		});

		timeline2.add({
			targets: '.l_eye',
			d: [{ value: expressionPath.l_eye }]
		});

		const timeline3 = anime.timeline({
			duration: time,
			easing: 'easeOutExpo'
		});

		timeline3.add({
			targets: '.r_eyebrow',
			d: [{ value: expressionPath.r_eyebrow }]
		});

		const timeline4 = anime.timeline({
			duration: time,
			easing: 'easeOutExpo'
		});

		timeline4.add({
			targets: '.l_eyebrow',
			d: [{ value: expressionPath.l_eyebrow }]
		});

		// TODO: insert mouse_color property to the paths
		let mouse_color = '';

		if (expressionPath.expression === 'anger') {
			mouse_color = '#000';
		} else {
			mouse_color = '#FF3D3D';
		}

		const timeline5 = anime.timeline({
			duration: time,
			easing: 'easeOutExpo'
		});

		timeline5.add({
			targets: '.mouse',
			d: [{ value: expressionPath.mouse }],
			fill: [{ value: mouse_color }]
		});

		// TODO: anime
		anime
			.timeline({
				duration: 200
			})
			.add({
				begin: function () {
					if (expressionPath.expression !== 'sadness') {
						(document.querySelector('.option_sad1') as HTMLElement).style.display = 'none';
						(document.querySelector('.option_sad2') as HTMLElement).style.display = 'none';
					}
				},
				complete: function () {
					if (expressionPath.expression === 'sadness') {
						(document.querySelector('.option_sad1') as HTMLElement).style.display = 'block';
						(document.querySelector('.option_sad2') as HTMLElement).style.display = 'block';
					}
				}
			});

		anime
			.timeline({
				duration: 200
			})
			.add({
				begin: function () {
					if (expressionPath.expression !== 'fear') {
						(document.querySelector('.option_fear1') as HTMLElement).style.display = 'none';
						(document.querySelector('.option_fear2') as HTMLElement).style.display = 'none';
					}
				},
				complete: function () {
					if (expressionPath.expression === 'fear') {
						(document.querySelector('.option_fear1') as HTMLElement).style.display = 'block';
						(document.querySelector('.option_fear2') as HTMLElement).style.display = 'block';
					}
				}
			});

		anime
			.timeline({
				duration: 300
			})
			.add({
				begin: function () {
					if (expressionPath.expression !== 'disgust') {
						(document.querySelector('.option_disgust') as HTMLElement).style.display = 'none';
					}
				},
				complete: function () {
					if (expressionPath.expression === 'disgust') {
						(document.querySelector('.option_disgust') as HTMLElement).style.display = 'block';
					}
				}
			});

		anime
			.timeline({
				duration: 200
			})
			.add({
				begin: function () {
					if (expressionPath.expression !== 'think') {
						document.querySelectorAll('.option_think').forEach((_think) => {
							(_think as HTMLElement).style.display = 'none';
						});
					}
				},
				complete: function () {
					if (expressionPath.expression === 'think') {
						document.querySelectorAll('.option_think').forEach((_think) => {
							(_think as HTMLElement).style.display = 'block';
						});
					}
				}
			});

		anime
			.timeline({
				duration: 200
			})
			.add({
				begin: function () {
					if (expressionPath.expression !== 'listen') {
						document.querySelectorAll('.option_listen').forEach((_listen) => {
							(_listen as HTMLElement).style.display = 'none';
						});
					}
				},
				complete: function () {
					if (expressionPath.expression === 'listen') {
						document.querySelectorAll('.option_listen').forEach((_listen) => {
							(_listen as HTMLElement).style.display = 'block';
						});
					}
				}
			});
	};

	$: {
		currentExpression;
		browser && morph(expressionPaths[$currentExpression]);
	}
</script>

<div class="expression-container">
	<svg
		class="expression"
		id={$currentExpression}
		width={exprSize}
		height={exprSize}
		viewBox="0 0 250 250"
		fill="none"
		xmlns="http://www.w3.org/2000/svg"
	>
		<!-- face -->
		<circle class="face" cx="125" cy="125" r="125" fill="#FFE600" />
		<path
			class="l_eye"
			d="M88.5 113C88.5 125.703 86.7025 136 74 136C61.2975 136 59 125.703 59 113C59 100.297 61.2975 90 74 90C86.7025 90 88.5 100.297 88.5 113Z"
			fill="black"
		/>
		<path
			class="r_eye"
			d="M189.5 113C189.5 125.703 187.703 136 175 136C162.297 136 160 125.703 160 113C160 100.297 162.297 90 175 90C187.703 90 189.5 100.297 189.5 113Z"
			fill="black"
		/>
		<path
			class="mouse"
			class:talk={$isTalking}
			id="mouse"
			d="M141 184.582C141 192.942 133.837 194 125 194C116.163 194 109 192.942 109 184.582C109 176.223 116.163 178.205 125 178.205C133.837 178.205 141 176.223 141 184.582Z"
			fill="#FF3D3D"
		/>
		<path
			class="r_eyebrow"
			d="M199.5 67.5789C199.5 67.5789 188.307 48.5789 174.5 48.5789C160.693 48.5789 149.5 67.5789 149.5 67.5789C149.5 53.7717 160.693 42.5789 174.5 42.5789C188.307 42.5789 199.5 53.7717 199.5 67.5789Z"
			fill="black"
		/>
		<path
			class="l_eyebrow"
			d="M99 68C99 68 87.8071 49 74 49C60.1929 49 49 68 49 68C49 54.1929 60.1929 43 74 43C87.8071 43 99 54.1929 99 68Z"
			fill="black"
		/>

		<!-- emotions -->
		<path
			class="option_sad1"
			style="display: none"
			d="M194 115L199.735 134.007C200.488 136.504 199.539 139.202 197.388 140.677C195.346 142.077 192.654 142.077 190.612 140.677C188.461 139.202 187.512 136.504 188.265 134.007L194 115Z"
			fill="#0073ff"
		/>
		<path
			class="option_sad2"
			style="display: none"
			d="M56 115L61.7348 134.007C62.4883 136.504 61.539 139.202 59.3876 140.677C57.3461 142.077 54.6539 142.077 52.6124 140.677C50.4611 139.202 49.5117 136.504 50.2653 134.007L56 115Z"
			fill="#0073ff"
		/>
		<path
			class="option_fear1"
			style="display: none"
			d="M35 84L40.7348 103.007C41.4883 105.504 40.539 108.202 38.3876 109.677V109.677C36.3461 111.077 33.6539 111.077 31.6124 109.677V109.677C29.4611 108.202 28.5117 105.504 29.2653 103.007L35 84Z"
			fill="#fbfff0"
		/>
		<path
			class="option_fear2"
			style="display: none"
			d="M17 113L22.7348 132.007C23.4883 134.504 22.539 137.202 20.3876 138.677V138.677C18.3461 140.077 15.6539 140.077 13.6124 138.677V138.677C11.4611 137.202 10.5117 134.504 11.2653 132.007L17 113Z"
			fill="#fbfff0"
		/>
		<path
			class="option_disgust"
			style="display: none"
			d="M130.617 181.553C134.43 184.427 130.687 186.255 126.662 183.686C124.299 182.179 121.606 181.024 118.666 180.702C115.727 180.38 112.847 180.924 110.215 181.884C105.728 183.52 102.47 180.925 106.815 178.945C110.317 177.349 114.574 176.637 119.058 177.128C123.542 177.62 127.543 179.236 130.617 181.553Z"
			fill="black"
		/>

		<!-- status: listen -->
		<path
			class="option_listen"
			d="M269.6 155.276C258.494 181.199 235.1 196.049 217.348 188.444C199.596 180.839 200.91 154.853 212.016 128.93C223.121 103.007 239.812 86.9626 257.564 94.5677C275.317 102.173 280.705 129.353 269.6 155.276Z"
			fill="#FFE600"
		/>
		<mask class="option_listen" id="path-8-inside-1" fill="white">
			<path
				class="option_listen"
				d="M256.351 146.086C257.115 147.141 258.646 147.283 259.501 146.288C261.383 144.095 262.895 141.523 263.949 138.705C265.305 135.079 265.861 131.158 265.566 127.288C265.272 123.419 264.137 119.72 262.262 116.521C260.387 113.322 257.83 110.72 254.817 108.946C251.804 107.173 248.428 106.282 244.989 106.353C241.55 106.424 238.153 107.455 235.099 109.354C232.045 111.253 229.429 113.961 227.483 117.24C225.877 119.944 224.767 122.968 224.215 126.124C224.02 127.236 224.85 128.231 225.974 128.333V128.333C227.098 128.436 228.088 127.605 228.303 126.497C228.768 124.101 229.634 121.808 230.859 119.746C232.424 117.109 234.528 114.931 236.984 113.404C239.44 111.876 242.172 111.047 244.938 110.99C247.704 110.933 250.419 111.649 252.842 113.076C255.265 114.502 257.321 116.595 258.829 119.168C260.337 121.741 261.25 124.715 261.487 127.827C261.723 130.939 261.277 134.093 260.186 137.009C259.329 139.3 258.096 141.388 256.56 143.164C255.843 143.991 255.713 145.205 256.351 146.086V146.086Z"
			/>
		</mask>
		<path
			class="option_listen"
			d="M256.351 146.086C257.115 147.141 258.646 147.283 259.501 146.288C261.383 144.095 262.895 141.523 263.949 138.705C265.305 135.079 265.861 131.158 265.566 127.288C265.272 123.419 264.137 119.72 262.262 116.521C260.387 113.322 257.83 110.72 254.817 108.946C251.804 107.173 248.428 106.282 244.989 106.353C241.55 106.424 238.153 107.455 235.099 109.354C232.045 111.253 229.429 113.961 227.483 117.24C225.877 119.944 224.767 122.968 224.215 126.124C224.02 127.236 224.85 128.231 225.974 128.333V128.333C227.098 128.436 228.088 127.605 228.303 126.497C228.768 124.101 229.634 121.808 230.859 119.746C232.424 117.109 234.528 114.931 236.984 113.404C239.44 111.876 242.172 111.047 244.938 110.99C247.704 110.933 250.419 111.649 252.842 113.076C255.265 114.502 257.321 116.595 258.829 119.168C260.337 121.741 261.25 124.715 261.487 127.827C261.723 130.939 261.277 134.093 260.186 137.009C259.329 139.3 258.096 141.388 256.56 143.164C255.843 143.991 255.713 145.205 256.351 146.086V146.086Z"
			fill="#C4C4C4"
			stroke="black"
			stroke-width="10"
			mask="url(#path-8-inside-1)"
		/>
		<mask class="option_listen" id="path-9-inside-2" fill="white">
			<path
				class="option_listen"
				d="M223.858 145.876C223.454 147.106 224.117 148.51 225.392 148.628C226.216 148.704 227.054 148.663 227.889 148.502C229.505 148.19 231.06 147.44 232.424 146.312C233.789 145.184 234.924 143.711 235.736 142.014C236.549 140.318 237.015 138.447 237.097 136.555C237.179 134.664 236.873 132.805 236.207 131.134C235.54 129.463 234.53 128.026 233.261 126.943C231.993 125.859 230.501 125.16 228.909 124.902C227.908 124.74 226.887 124.756 225.877 124.945C224.83 125.141 224.3 126.257 224.563 127.333V127.333C224.89 128.67 226.32 129.385 227.648 129.482C227.801 129.493 227.954 129.511 228.106 129.536C229.074 129.692 229.981 130.118 230.753 130.777C231.525 131.436 232.139 132.309 232.544 133.326C232.95 134.342 233.135 135.472 233.086 136.623C233.036 137.774 232.752 138.912 232.258 139.943C231.764 140.975 231.074 141.871 230.244 142.557C229.414 143.243 228.468 143.699 227.485 143.889C227.281 143.928 227.076 143.956 226.871 143.972C225.602 144.071 224.262 144.645 223.858 145.876V145.876Z"
			/>
		</mask>
		<path
			class="option_listen"
			d="M223.858 145.876C223.454 147.106 224.117 148.51 225.392 148.628C226.216 148.704 227.054 148.663 227.889 148.502C229.505 148.19 231.06 147.44 232.424 146.312C233.789 145.184 234.924 143.711 235.736 142.014C236.549 140.318 237.015 138.447 237.097 136.555C237.179 134.664 236.873 132.805 236.207 131.134C235.54 129.463 234.53 128.026 233.261 126.943C231.993 125.859 230.501 125.16 228.909 124.902C227.908 124.74 226.887 124.756 225.877 124.945C224.83 125.141 224.3 126.257 224.563 127.333V127.333C224.89 128.67 226.32 129.385 227.648 129.482C227.801 129.493 227.954 129.511 228.106 129.536C229.074 129.692 229.981 130.118 230.753 130.777C231.525 131.436 232.139 132.309 232.544 133.326C232.95 134.342 233.135 135.472 233.086 136.623C233.036 137.774 232.752 138.912 232.258 139.943C231.764 140.975 231.074 141.871 230.244 142.557C229.414 143.243 228.468 143.699 227.485 143.889C227.281 143.928 227.076 143.956 226.871 143.972C225.602 144.071 224.262 144.645 223.858 145.876V145.876Z"
			fill="#C4C4C4"
			stroke="black"
			stroke-width="10"
			mask="url(#path-9-inside-2)"
		/>
		<mask class="option_listen" id="path-10-inside-3" fill="white">
			<path
				class="option_listen"
				d="M233.121 163.704C232.605 164.784 233.027 166.156 234.134 166.576C236.379 167.426 238.82 167.682 241.303 167.314C244.525 166.837 247.698 165.328 250.482 162.949C253.267 160.57 255.56 157.41 257.117 153.805C258.358 150.928 259.094 147.854 259.282 144.796C259.356 143.602 258.29 142.691 257.188 142.917V142.917C256.356 143.088 255.786 143.864 255.744 144.766C255.625 147.31 255.029 149.875 253.996 152.269C252.751 155.152 250.917 157.68 248.69 159.583C246.462 161.486 243.925 162.692 241.347 163.074C239.509 163.346 237.7 163.192 236.017 162.627C234.898 162.252 233.638 162.625 233.121 163.704V163.704Z"
			/>
		</mask>
		<path
			class="option_listen"
			d="M233.121 163.704C232.605 164.784 233.027 166.156 234.134 166.576C236.379 167.426 238.82 167.682 241.303 167.314C244.525 166.837 247.698 165.328 250.482 162.949C253.267 160.57 255.56 157.41 257.117 153.805C258.358 150.928 259.094 147.854 259.282 144.796C259.356 143.602 258.29 142.691 257.188 142.917V142.917C256.356 143.088 255.786 143.864 255.744 144.766C255.625 147.31 255.029 149.875 253.996 152.269C252.751 155.152 250.917 157.68 248.69 159.583C246.462 161.486 243.925 162.692 241.347 163.074C239.509 163.346 237.7 163.192 236.017 162.627C234.898 162.252 233.638 162.625 233.121 163.704V163.704Z"
			fill="#C4C4C4"
			stroke="black"
			stroke-width="10"
			mask="url(#path-10-inside-3)"
		/>

		<!-- status: think -->
		<circle
			class="option_think"
			id="think_light"
			cx="224.424"
			cy="49.424"
			r="35.424"
			fill="#2EC0FF"
		/>
		<ellipse
			class="option_think"
			cx="224.424"
			cy="97.6863"
			rx="16.4044"
			ry="13.3137"
			fill="#454545"
		/>
		<line
			class="option_think"
			x1="234.5"
			y1="37"
			x2="234.5"
			y2="80.9781"
			stroke="black"
			stroke-width="3"
		/>
		<line
			class="option_think"
			x1="215.5"
			y1="37"
			x2="215.5"
			y2="81"
			stroke="black"
			stroke-width="3"
		/>
		<rect
			class="option_think"
			x="208.02"
			y="80.5686"
			width="32.8088"
			height="21.3971"
			fill="#C4C4C4"
		/>
		<line
			class="option_think"
			x1="221.333"
			y1="84.299"
			x2="240.829"
			y2="84.299"
			stroke="black"
			stroke-width="3"
		/>
		<line
			class="option_think"
			x1="221.333"
			y1="89.5294"
			x2="240.829"
			y2="89.5294"
			stroke="black"
			stroke-width="3"
		/>
		<line
			class="option_think"
			x1="208.02"
			y1="96.6618"
			x2="227.515"
			y2="96.6618"
			stroke="black"
			stroke-width="3"
		/>
		<line
			class="option_think"
			x1="209"
			y1="43.5"
			x2="241"
			y2="43.5"
			stroke="black"
			stroke-width="3"
		/>
		<mask class="option_think" id="path-16-inside-1" fill="white">
			<path
				class="option_think"
				d="M240.5 45C241.983 45 243.433 44.5601 244.667 43.736C245.9 42.9119 246.861 41.7406 247.429 40.3701C247.997 38.9997 248.145 37.4917 247.856 36.0368C247.567 34.582 246.852 33.2456 245.803 32.1967C244.754 31.1478 243.418 30.4335 241.963 30.1441C240.508 29.8547 239 30.0032 237.63 30.5709C236.259 31.1386 235.088 32.0999 234.264 33.3332C233.44 34.5666 233 36.0166 233 37.5L236.019 37.5C236.019 36.6137 236.281 35.7472 236.774 35.0103C237.266 34.2733 237.966 33.6989 238.785 33.3597C239.604 33.0205 240.505 32.9318 241.374 33.1047C242.244 33.2776 243.042 33.7044 243.669 34.3312C244.296 34.9579 244.722 35.7564 244.895 36.6257C245.068 37.495 244.979 38.3961 244.64 39.215C244.301 40.0338 243.727 40.7337 242.99 41.2261C242.253 41.7186 241.386 41.9814 240.5 41.9814V45Z"
			/>
		</mask>
		<path
			class="option_think"
			d="M240.5 45C241.983 45 243.433 44.5601 244.667 43.736C245.9 42.9119 246.861 41.7406 247.429 40.3701C247.997 38.9997 248.145 37.4917 247.856 36.0368C247.567 34.582 246.852 33.2456 245.803 32.1967C244.754 31.1478 243.418 30.4335 241.963 30.1441C240.508 29.8547 239 30.0032 237.63 30.5709C236.259 31.1386 235.088 32.0999 234.264 33.3332C233.44 34.5666 233 36.0166 233 37.5L236.019 37.5C236.019 36.6137 236.281 35.7472 236.774 35.0103C237.266 34.2733 237.966 33.6989 238.785 33.3597C239.604 33.0205 240.505 32.9318 241.374 33.1047C242.244 33.2776 243.042 33.7044 243.669 34.3312C244.296 34.9579 244.722 35.7564 244.895 36.6257C245.068 37.495 244.979 38.3961 244.64 39.215C244.301 40.0338 243.727 40.7337 242.99 41.2261C242.253 41.7186 241.386 41.9814 240.5 41.9814V45Z"
			fill="#C4C4C4"
			stroke="black"
			stroke-width="6"
			mask="url(#path-16-inside-1)"
		/>
		<mask class="option_think" id="path-17-inside-2" fill="white">
			<path
				class="option_think"
				d="M209.5 45C208.017 45 206.567 44.5601 205.333 43.736C204.1 42.9119 203.139 41.7406 202.571 40.3701C202.003 38.9997 201.855 37.4917 202.144 36.0368C202.433 34.582 203.148 33.2456 204.197 32.1967C205.246 31.1478 206.582 30.4335 208.037 30.1441C209.492 29.8547 211 30.0032 212.37 30.5709C213.741 31.1386 214.912 32.0999 215.736 33.3332C216.56 34.5666 217 36.0166 217 37.5L214.017 37.5C214.017 36.6066 213.752 35.7333 213.256 34.9904C212.759 34.2476 212.054 33.6686 211.229 33.3268C210.403 32.9849 209.495 32.8954 208.619 33.0697C207.743 33.244 206.938 33.6742 206.306 34.3059C205.674 34.9377 205.244 35.7425 205.07 36.6188C204.895 37.495 204.985 38.4032 205.327 39.2286C205.669 40.054 206.248 40.7595 206.99 41.2558C207.733 41.7522 208.607 42.0171 209.5 42.0171V45Z"
			/>
		</mask>
		<path
			class="option_think"
			d="M209.5 45C208.017 45 206.567 44.5601 205.333 43.736C204.1 42.9119 203.139 41.7406 202.571 40.3701C202.003 38.9997 201.855 37.4917 202.144 36.0368C202.433 34.582 203.148 33.2456 204.197 32.1967C205.246 31.1478 206.582 30.4335 208.037 30.1441C209.492 29.8547 211 30.0032 212.37 30.5709C213.741 31.1386 214.912 32.0999 215.736 33.3332C216.56 34.5666 217 36.0166 217 37.5L214.017 37.5C214.017 36.6066 213.752 35.7333 213.256 34.9904C212.759 34.2476 212.054 33.6686 211.229 33.3268C210.403 32.9849 209.495 32.8954 208.619 33.0697C207.743 33.244 206.938 33.6742 206.306 34.3059C205.674 34.9377 205.244 35.7425 205.07 36.6188C204.895 37.495 204.985 38.4032 205.327 39.2286C205.669 40.054 206.248 40.7595 206.99 41.2558C207.733 41.7522 208.607 42.0171 209.5 42.0171V45Z"
			fill="#C4C4C4"
			stroke="black"
			stroke-width="6"
			mask="url(#path-17-inside-2)"
		/>
	</svg>
</div>

<style>
	.expression {
		overflow: visible;
	}
	/* init */
	.option_listen,
	.option_think {
		display: none;
	}

	/* expression */
	.r_eye,
	.l_eye {
		transform-origin: 50%;
		animation: _blink 3s infinite;
		animation-delay: 3s;
	}

	.talk {
		transform-origin: 50%;
		transform-box: fill-box;
		animation: _talk 2s infinite;
	}

	#happiness .r_eye,
	#happiness .l_eye,
	#disgust .r_eye,
	#disgust .l_eye,
	#sadness .r_eye,
	#sadness .l_eye {
		animation: none;
	}

	@keyframes _blink {
		0%,
		100% {
			transform: scale(1, 0.05);
		}
		7%,
		93% {
			transform: scale(1, 1);
		}
	}

	@keyframes _talk {
		0%,
		50%,
		100% {
			transform: scale(1, 1);
		}
		20%,
		80% {
			transform: scale(1, 1.5);
		}
	}

	#happiness .talk,
	#surprise .talk,
	#surprise .r_eye,
	#surprise .l_eye {
		transform-origin: top;
		transform-box: fill-box;
		animation: _bigmousetalk 2s infinite;
	}

	@keyframes _bigmousetalk {
		0%,
		50%,
		100% {
			transform: scale(1, 1);
		}
		20%,
		80% {
			transform: scale(0.9, 0.9);
		}
	}

	.option_sad1 {
		animation: _drop 1.5s linear infinite both;
		animation-delay: 0.3s;
	}
	.option_sad2 {
		animation: _drop 1.5s linear infinite both;
	}
	@keyframes _drop {
		0% {
			transform: translate(0);
			opacity: 1;
		}
		25% {
			transform: translate(0px, 50px);
		}
		50% {
			transform: translate(0px, 100px);
			opacity: 0;
		}
		80%,
		100% {
			opacity: 0;
		}
	}

	#anger .r_eyebrow,
	#disgust .r_eyebrow,
	#sadness .r_eyebrow {
		animation: eyebrow_R 1s linear infinite both;
	}
	#anger .l_eyebrow,
	#disgust .l_eyebrow,
	#sadness .l_eyebrow {
		animation: eyebrow_L 1s linear infinite both;
	}

	@keyframes eyebrow_R {
		0%,
		100% {
			transform: translate(0);
		}
		50% {
			transform: translate(-5px, -5px);
		}
	}
	@keyframes eyebrow_L {
		0%,
		100% {
			transform: translate(0);
		}
		50% {
			transform: translate(5px, -5px);
		}
	}

	#contempt .l_eyebrow,
	#surprise .l_eyebrow,
	#surprise .r_eyebrow {
		animation: upDown 2s linear infinite both;
	}

	@keyframes upDown {
		0%,
		50%,
		100% {
			transform: translateY(-10px);
		}
		20%,
		80% {
			transform: translateY(0px);
		}
	}

	#disgust .talk {
		transform-box: fill-box;
		animation: _disgustTalk 2s linear infinite both;
	}

	@keyframes _disgustTalk {
		0%,
		50%,
		100% {
			transform: scale(0.7, 0.7);
		}
		20%,
		80% {
			transform: scale(0.5, 0.5);
		}
	}

	#contempt .talk {
		transform-box: fill-box;
		animation: _contemptTalk 3s linear infinite both;
	}

	@keyframes _contemptTalk {
		0%,
		50%,
		100% {
			transform: scale(1, 1);
		}
		20%,
		80% {
			transform: scale(0.5, 2) rotate(-10deg);
		}
	}

	#think_light {
		animation: colorChange 3s infinite;
	}

	@keyframes colorChange {
		0% {
			fill: #fa8c8c;
		}
		20% {
			fill: #fac98c;
		}
		40% {
			fill: #c9fa8c;
		}
		60% {
			fill: #8ce6fa;
		}
		80% {
			fill: #998cfa;
		}
		100% {
			fill: #fa8c8c;
		}
	}
</style>
